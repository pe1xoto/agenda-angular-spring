<div class="container mt-4">
  <div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h3>Cadastro de Pessoas</h3>
      <div>
        <button
          type="button"
          class="btn btn-primary me-2"
          (click)="adicionar()"
          [disabled]="carregando()"
        >
          @if (!carregando()) { Adicionar } @if (carregando()) {
          <span class="spinner-border spinner-border-sm"></span>
          }
        </button>
        <button
          type="button"
          class="btn btn-warning me-2"
          (click)="atualizar()"
          [disabled]="!pessoaSelecionada.id || carregando()"
        >
          Atualizar
        </button>
        <button
          type="button"
          class="btn btn-danger"
          (click)="remover()"
          [disabled]="!pessoaSelecionada.id || carregando()"
        >
          Excluir
        </button>
      </div>
    </div>

    @if (mensagem()) {
    <div class="alert alert-info m-3">
      {{ mensagem() }}
    </div>
    }

    <div class="card-body">
      <form>
        <div class="row mb-3">
          <div class="col-md-2">
            <label class="form-label">Código</label>
            <input
              type="number"
              class="form-control"
              [(ngModel)]="pessoaSelecionada.id"
              name="id"
              readonly
            />
          </div>
          <div class="col-md-6">
            <label class="form-label">Nome</label>
            <input
              type="text"
              class="form-control"
              [(ngModel)]="pessoaSelecionada.nome"
              name="nome"
              required
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">CPF/CNPJ</label>
            <input
              type="text"
              class="form-control"
              [(ngModel)]="pessoaSelecionada.cpfCnpj"
              name="cpfCnpj"
              required
            />
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-md-4">
            <label class="form-label">Telefone</label>
            <input
              type="tel"
              class="form-control"
              [(ngModel)]="pessoaSelecionada.telefone"
              name="telefone"
              required
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">E-mail</label>
            <input
              type="email"
              class="form-control"
              [(ngModel)]="pessoaSelecionada.email"
              name="email"
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">Função</label>
            <input
              type="text"
              class="form-control"
              [(ngModel)]="pessoaSelecionada.funcao"
              name="funcao"
            />
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-md-4">
            <label class="form-label">Login</label>
            <input
              type="text"
              class="form-control"
              [(ngModel)]="pessoaSelecionada.login"
              name="login"
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">Senha</label>
            <input
              type="password"
              class="form-control"
              [(ngModel)]="pessoaSelecionada.senha"
              name="senha"
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">Perfil</label>
            <input
              type="text"
              class="form-control"
              [(ngModel)]="pessoaSelecionada.perfil"
              name="perfil"
            />
          </div>
        </div>
      </form>
    </div>

    <div class="card-body">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th>Código</th>
            <th>Nome</th>
            <th>CPF/CNPJ</th>
            <th>Telefone</th>
            <th>E-mail</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
          @for (pessoa of pessoas(); track pessoa.id) {
          <tr>
            <td>{{ pessoa.id }}</td>
            <td>{{ pessoa.nome }}</td>
            <td>{{ pessoa.cpfCnpj }}</td>
            <td>{{ pessoa.telefone }}</td>
            <td>{{ pessoa.email }}</td>
            <td>
              <button
                type="button"
                class="btn btn-sm btn-secondary"
                (click)="carregarDados(pessoa)"
              >
                Editar
              </button>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
  </div>
</div>
